# 2K历史选秀年份生成器 - GUI版

这是一个基于 tkinter 的图形界面版本，将原有的命令行工具转换为带图形界面的应用程序。

## 文件说明

- `gui_main.py` - GUI 主程序
- `2KDraftPicker.bat` - 启动脚本 (Windows)
- `build_exe.bat` - 可执行文件构建脚本
- `main.py` - 原始命令行版本 (保留)

## 运行方式

### 方式1：使用 Python 运行 (推荐)
```bash
# 确保已安装依赖
pip install python-dotenv

# 运行 GUI 程序
python gui_main.py
```

### 方式2：使用启动脚本
1. 双击 `2KDraftPicker.bat`
2. 脚本会自动检查依赖并启动程序

### 方式3：构建独立可执行文件
1. 运行 `build_exe.bat`
2. 构建完成后，可执行文件位于 `dist/2KDraftPicker.exe`
3. 双击 `dist/2KDraftPicker.exe` 即可运行

## GUI 功能介绍

应用程序界面包含以下主要功能：

### 主界面布局
- **顶部**: 程序标题
- **状态区**: 显示当前模拟年份、可用年份数量、冷却中年份数量
- **操作按钮**: 执行各种功能的按钮
- **结果显示区**: 显示选秀结果和详细信息
- **年份信息区**: 显示当前可用年份范围

### 功能按钮说明

1. **进行选秀** - 执行一次选秀操作：
   - 随机选择一个可用的选秀年份
   - 随机选择8个需要"废掉"的球员（按球队英文名排序）
   - 更新年份冷却状态
   - 模拟时间推进一年

2. **重置所有年份** - 重置所有年份的权重和冷却状态：
   - 所有达到20年规则的年份将重新变为可用
   - 清除所有使用记录

3. **查看可用年份** - 显示当前可用年份和冷却中年份：
   - 显示可用年份列表
   - 显示冷却中年份及剩余冷却时间

4. **重置当前年份到{年份}** - 将当前模拟年份重置到初始值
5. **退出程序** - 安全退出应用程序

### 状态显示
- **当前模拟年份**: 显示当前的模拟年份
- **可用年份数量**: 显示当前可用的选秀年份数量
- **冷却中年份数量**: 显示处于冷却期的年份数量

## 数据文件

程序运行时需要以下数据文件：

1. `.env` - 配置文件，包含 `SIMULATION_START_YEAR` 设置
2. `current_year.json` - 存储当前模拟年份
3. `draft_weights.json` - 存储年份权重和冷却状态

**注意**: 如果这些文件不存在，程序会在第一次运行时自动创建。

## 系统要求

- Windows 7/8/10/11 (已测试)
- Python 3.6+ (推荐 3.8+)
- tkinter (通常随 Python 安装)
- python-dotenv (自动安装)

## 与原始版本的对比

| 功能 | 命令行版本 | GUI 版本 |
|------|------------|----------|
| 进行选秀 | 命令行交互 | 一键操作 |
| 查看状态 | 需要输入命令 | 实时显示 |
| 重置功能 | 菜单选择 | 按钮点击 |
| 结果显示 | 控制台输出 | 格式化显示 |
| 错误处理 | 命令行错误信息 | 弹窗提示 |

## 故障排除

### 常见问题

1. **无法启动程序**
   - 检查 Python 是否正确安装：`python --version`
   - 确保已安装 python-dotenv：`pip install python-dotenv`

2. **界面显示乱码**
   - 脚本已设置 UTF-8 编码
   - 确保系统支持中文字符集

3. **年份数据异常**
   - 可以删除 `current_year.json` 和 `draft_weights.json` 重新开始
   - 检查 `.env` 文件中的 `SIMULATION_START_YEAR` 设置

4. **构建可执行文件失败**
   - 确保已安装 pyinstaller：`pip install pyinstaller`
   - 确保有足够的磁盘空间

### 日志文件

程序运行日志保存在 `logs/` 目录下：
- `simulation_YYYYMMDD_HHMMSS.json` - 详细模拟日志
- `summary_YYYYMMDD_HHMMSS.txt` - 汇总报告
- `log_index.txt` - 日志索引文件

## 开发说明

### 代码结构
```python
gui_main.py
├── DraftApp 类
│   ├── __init__()      # 初始化界面
│   ├── setup_ui()      # 创建UI组件
│   ├── update_display() # 更新状态显示
│   ├── run_draft()     # 执行选秀
│   ├── reset_all_weights() # 重置权重
│   └── 其他辅助方法
├── 核心逻辑函数 (从main.py移植)
└── 常量定义
```

### 添加新功能
1. 在 `setup_ui()` 中添加新的UI组件
2. 创建对应的处理方法
3. 更新状态显示逻辑

## 许可证

同原始项目。

## 更新日志

### v1.0.0 (GUI版本)
- 首次发布 GUI 版本
- 基于 tkinter 的图形界面
- 完整移植所有功能
- 支持一键构建可执行文件